var ye=Object.defineProperty,ge=Object.defineProperties;var he=Object.getOwnPropertyDescriptors;var ne=Object.getOwnPropertySymbols;var Ce=Object.prototype.hasOwnProperty,ke=Object.prototype.propertyIsEnumerable;var oe=(l,t,e)=>t in l?ye(l,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):l[t]=e,X=(l,t)=>{for(var e in t||(t={}))Ce.call(t,e)&&oe(l,e,t[e]);if(ne)for(var e of ne(t))ke.call(t,e)&&oe(l,e,t[e]);return l},se=(l,t)=>ge(l,he(t));import{r as H,o as i,c as f,a as k,F as b,b as c,d as w,e as Y,f as j,g as S,h as T,u,i as U,j as G,n as L,t as B,l as A,k as ae,w as J,m as ze,p as be,q as re,s as $,v as q,x,y as K,z as F,A as ie,B as we,C as $e,T as Ie,D as xe,E as W,G as Z,H as Q,I as ue,J as Se,K as Te,L as Me}from"./vendor.2745e27f.js";const Pe=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function e(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerpolicy&&(a.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?a.credentials="include":n.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(n){if(n.ep)return;n.ep=!0;const a=e(n);fetch(n.href,a)}};Pe();var O=(l,t)=>{const e=l.__vccOpts||l;for(const[o,n]of t)e[o]=n;return e};const Ne={},Ue=c("div",{id:"modal-target"},null,-1);function Ge(l,t){const e=H("router-view");return i(),f(b,null,[k(e),Ue],64)}var Oe=O(Ne,[["render",Ge]]);const R=w({spacePressed:!1,intention:"build"});function Ve(l){const{toggleCellValue:t,movePlayerCursor:e}=l;function o(n){n.key==="ArrowLeft"?(e("left"),R.value.spacePressed&&t("d")):n.key==="ArrowRight"?(e("right"),R.value.spacePressed&&t("d")):n.key==="ArrowUp"?(e("up"),R.value.spacePressed&&t("d")):n.key==="ArrowDown"?(e("down"),R.value.spacePressed&&t("d")):n.key==="f"?t("x"):n.key===" "&&(R.value.spacePressed=!0,t("d"))}Y(()=>{window.addEventListener("keydown",o),window.addEventListener("keyup",n=>{n.key===" "&&(R.value.spacePressed=!1)})}),j(()=>{window.removeEventListener("keydown",o)})}const Ee={key:0,class:"corner"},Le={key:1,class:"legend horizontal"},Ae={key:2,class:"legend vertical"},Re=["onMouseover","onClick","onContextmenu","i"],He=S({props:{enableControls:{type:Boolean,default:!1},enableSocket:{type:Boolean,default:!1},players:null,player:null,game:null},emits:["onCellClicked","onCellRightClicked","gridChanged","moveCursor","toggleCellValue","onCellHover"],setup(l,{emit:t}){const{gridSize:e,indexToXY:o,hitsInColumns:n,hitsInRows:a,levelIsCleared:s,grid:d,solution:C}=l.game,z=T(()=>{var r;return(r=l.player)==null?void 0:r.position});l.enableControls&&Ve({toggleCellValue:r=>{t("toggleCellValue",r)},movePlayerCursor:r=>{t("moveCursor",r)}});function m(r){if(!(!z||!l.player||!l.players||A.exports.isEqual(o(r),z))&&l.enableSocket){const N=Object.values(l.players).find(_=>A.exports.isEqual(o(r),_.position));return N?`box-shadow: 0px 0px 0px 2px ${N.color}; z-index: 2;`:void 0}}const M=T(()=>{const r=u(C)?"auto repeat(10, 1fr)":"repeat(10, 1fr)";return`
    grid-template-columns: ${r};
    grid-template-rows: ${r};
  `});function h(r,I){const[N,_]=o(r);return u(d)[_][N]===I}function P(r){if(!!l.player)return l.player.position[0]===r}function p(r){if(!!l.player)return l.player.position[1]===r}function g(r){!l.enableControls||t("onCellClicked",r)}function v(r){!l.enableControls||t("onCellRightClicked",r)}function y(r){!l.enableControls||t("onCellHover",r)}return(r,I)=>(i(),f("div",{class:L(["playfield-container",{cleared:u(s)}]),style:ae(u(M))},[u(C)?(i(),f("div",Ee)):U("",!0),u(C)?(i(),f("div",Le,[(i(!0),f(b,null,G(u(e),(N,_)=>(i(),f("div",{class:L(["cell",{highlighted:P(_)}]),key:_},[(i(!0),f(b,null,G(u(n)[_],(V,E)=>(i(),f("div",{key:E,class:"hit"},B(V),1))),128))],2))),128))])):U("",!0),u(C)?(i(),f("div",Ae,[(i(!0),f(b,null,G(u(e),(N,_)=>(i(),f("div",{class:L(["cell",{highlighted:p(_)}]),key:_},[(i(!0),f(b,null,G(u(a)[_],(V,E)=>(i(),f("div",{key:E,class:"hit"},B(V),1))),128))],2))),128))])):U("",!0),(i(!0),f(b,null,G(u(e)*u(e),(N,_)=>{var V;return i(),f("div",{class:L(["cell",{cursor:u(A.exports.isEqual)((V=l.player)==null?void 0:V.position,u(o)(_)),filled:h(_,"d"),flagged:h(_,"x")}]),key:_,style:ae(m(_)),onMouseover:E=>y(_),onClick:E=>g(_),onContextmenu:J(E=>v(_),["right","prevent"]),i:_},null,46,Re)}),128))],6))}});var ee=O(He,[["__scopeId","data-v-5c119636"]]);function te(l){return new Array(l).fill("").map(t=>new Array(l).fill(" "))}const Be=()=>{const l={transports:["websocket"],upgrade:!1},t=ze({}.VUE_SOCKET_BASE_URL,X({path:{}.VUE_SOCKET_PATH},l));return j(()=>{t.disconnect()}),{socket:t}};function ce(l,t,e){const o=l==="multiplayer";let n=w(null),a=w({});o||(n.value="1",a.value={"1":{id:"1",position:[0,0],color:"green",name:"berend"}});const s=T(()=>{var m;return(m=d==null?void 0:d.value)==null?void 0:m.position}),d=T(()=>n.value!==null?a.value[n.value]:null);function C(m){a.value=m}function z(){Y(()=>{!o||(e.on("gridUpdated",t.setGrid),e.on("playersStateUpdated",C),e.on("playerCreated",m=>{n.value=m.id}),e.on("gameCreated",m=>t.setSolution(JSON.parse(m.solution))),e.emit("join",localStorage.getItem("nickName")))}),j(()=>{!o||(e.off("gridUpdated",m=>t.setGrid(m)),e.off("playersStateUpdated",C))})}return{players:a,player:d,playerId:n,cursor:s,initState:z}}function de(l){return l.reduce((t,e,o,n)=>(e==="d"&&(t.length>0&&n[o-1]==="d"?t[t.length-1]++:t.push(1)),t),[])}function pe(l){return l.map(t=>de(t))}function ve(l){const t=l.map((e,o,n)=>n.map(a=>a[o]));return t==null?void 0:t.map(e=>de(e))}const le=(l,t)=>{const e=w(l||te(10)),o=w(t||null),n=h=>{e.value=h},a=h=>{o.value=h},s=T(()=>e.value[0].length),d=h=>{const P=h%s.value,p=Math.floor(h/s.value);return[P,p]},C=h=>A.exports.clamp(h,0,s.value-1),z=T(()=>A.exports.isEqual(e.value,o==null?void 0:o.value)),m=T(()=>pe(o.value)),M=T(()=>ve(o.value));return{grid:e,solution:o,gridSize:s,hitsInRows:m,hitsInColumns:M,computeHitsInRows:pe,computeHitsInColumns:ve,levelIsCleared:z,indexToXY:d,clampToGrid:C,setGrid:n,setSolution:a}},D=be.create({baseURL:{}.VUE_API_URL});const fe=l=>(K("data-v-f4fa7640"),l=l(),F(),l),qe=x("\u2190 Back"),De={class:"container"},Xe=fe(()=>c("br",null,null,-1)),Ye={class:"now-playing"},je=fe(()=>c("span",{class:"online-indicator"},null,-1)),Je=S({props:{puzzleId:null},setup(l){const t=l.puzzleId?"singleplayer":"multiplayer",e=le(te(10)),{grid:o}=e;t==="singleplayer"&&D.get(`/puzzle/${l.puzzleId}`).then(p=>{e.setSolution(JSON.parse(p.data.puzzle))});const{socket:n}=Be(),{players:a,player:s,initState:d}=ce(t,e,n);d();function C(p){const[g,v]=e.indexToXY(p);o.value[v][g]=o.value[v][g]===" "?"d":" ",n.emit("gridUpdated",o.value)}function z(p){const[g,v]=e.indexToXY(p);o.value[v][g]=o.value[v][g]===" "?"x":" ",n.emit("gridUpdated",o.value)}function m(p){p==="left"&&(s.value.position[0]=e.clampToGrid(s.value.position[0]-1)),p==="right"&&(s.value.position[0]=e.clampToGrid(s.value.position[0]+1)),p==="up"&&(s.value.position[1]=e.clampToGrid(s.value.position[1]-1)),p==="down"&&(s.value.position[1]=e.clampToGrid(s.value.position[1]+1)),n.emit("cursorUpdated",s.value.position)}function M(p){s.value.position=e.indexToXY(p),n.emit("cursorUpdated",s.value.position)}function h(p){if(e.levelIsCleared.value)return;const[g,v]=s.value.position;o.value[v][g]=o.value[v][g]===p?" ":p,n.emit("gridUpdated",o.value)}function P(p){var g;return p.id===((g=s.value)==null?void 0:g.id)}return re(e.levelIsCleared,p=>{p&&(ie({zIndex:-1,particleCount:50,spread:70,angle:60,origin:{y:.6}}),ie({zIndex:-1,particleCount:50,spread:70,angle:120,origin:{y:.6}}))}),(p,g)=>{const v=H("router-link");return i(),f(b,null,[c("header",null,[k(v,{class:"link",to:{name:"mainMenu"}},{default:$(()=>[qe]),_:1})]),c("div",De,[u(e).grid&&u(e).solution?(i(),q(ee,{key:0,class:"grid","enable-controls":!0,"enable-socket":!0,game:u(e),player:u(s),players:u(a),onOnCellClicked:C,onOnCellRightClicked:z,onOnCellHover:M,onMoveCursor:m,onToggleCellValue:h},null,8,["game","player","players"])):U("",!0),c("aside",null,[Xe,c("span",Ye,"Now playing ("+B(Object.values(u(a)).length)+")",1),c("ul",null,[(i(!0),f(b,null,G(u(a),y=>(i(),f("li",{class:L([{"current-player":P(y)},y.id]),ref_for:!0,ref:"playersRef"},[je,x(" "+B(y.name),1)],2))),256))])])])],64)}}});var _e=O(Je,[["__scopeId","data-v-f4fa7640"]]);const Ke={class:"modal"},Fe=S({props:{visible:{type:Boolean}},emits:["close"],setup(l,{emit:t}){return we("Escape",()=>{!l.visible||t("close")}),(e,o)=>(i(),q(xe,{to:"#modal-target"},[k(Ie,null,{default:$(()=>[l.visible?(i(),f("div",{key:0,class:"backdrop",onClick:o[0]||(o[0]=J(n=>e.$emit("close"),["self"]))},[c("div",Ke,[$e(e.$slots,"default",{},void 0,!0)])])):U("",!0)]),_:3})]))}});var me=O(Fe,[["__scopeId","data-v-2272df04"]]);const We=["onSubmit"],Ze=["disabled"],Qe=S({props:{open:null,grid:null},emits:["close"],setup(l,{emit:t}){const e=w(""),o=W("nickName","");function n(a){D.post("/puzzle",{name:e.value,solution:JSON.stringify(l.grid),authorName:o.value}).then(s=>{t("close")}).catch(s=>{console.log(s)})}return(a,s)=>(i(),q(me,{visible:l.open,onClose:s[2]||(s[2]=d=>t("close"))},{default:$(()=>[c("form",{onSubmit:J(n,["prevent"])},[Z(c("input",{type:"text",placeholder:"Uw naam","onUpdate:modelValue":s[0]||(s[0]=d=>ue(o)?o.value=d:null)},null,512),[[Q,u(o)]]),Z(c("input",{type:"text",placeholder:"Puzzel naam","onUpdate:modelValue":s[1]||(s[1]=d=>e.value=d)},null,512),[[Q,e.value]]),c("button",{disabled:e.value===""||u(o)===""},"Save",8,Ze)],40,We)]),_:1},8,["visible"]))}}),et=c("p",null,"De puzzel is niet goed.",-1),tt=S({props:{open:null},emits:["close"],setup(l,{emit:t}){return(e,o)=>(i(),q(me,{visible:l.open,onClose:o[0]||(o[0]=n=>t("close"))},{default:$(()=>[et]),_:1},8,["visible"]))}});const lt=l=>(K("data-v-176dfd5c"),l=l(),F(),l),nt={class:"create"},ot=x("\u2190 Terug"),st={class:"btns-container"},at=lt(()=>c("button",{class:"btn btn-link"},"Clear",-1)),rt=S({setup(l){const t=w(!1),e=w(!1),o=le(te(10)),{grid:n,computeHitsInRows:a,computeHitsInColumns:s}=o;console.log("-> grid",n);const{player:d}=ce("singleplayer",o),C=w(!1),z=w(!1);function m(){const v=I=>I.length?I:[0],y=s(n.value).map(v),r=a(n.value).map(v);D.post("/validate-puzzle",{legendData:{rows:r,columns:y}}).then(I=>{C.value=!0,z.value=I.data})}const M=A.exports.debounce(m,400);function h(v){if(t.value||o.levelIsCleared.value)return;const[y,r]=d.value.position;n.value[r][y]=n.value[r][y]===v?" ":v}function P(v){const[y,r]=o.indexToXY(v);n.value[r][y]=n.value[r][y]===" "?"d":" "}function p(v){t.value||(v==="left"&&(d.value.position[0]=o.clampToGrid(d.value.position[0]-1)),v==="right"&&(d.value.position[0]=o.clampToGrid(d.value.position[0]+1)),v==="up"&&(d.value.position[1]=o.clampToGrid(d.value.position[1]-1)),v==="down"&&(d.value.position[1]=o.clampToGrid(d.value.position[1]+1)))}function g(){z.value?t.value=!0:e.value=!0}return re(n,()=>{C.value=!1,M()},{deep:!0}),(v,y)=>{const r=H("router-link");return i(),f("div",nt,[c("header",null,[k(r,{class:"link",to:{name:"mainMenu"}},{default:$(()=>[ot]),_:1})]),k(tt,{open:e.value,onClose:y[0]||(y[0]=I=>e.value=!1)},null,8,["open"]),k(Qe,{open:t.value,onClose:y[1]||(y[1]=I=>t.value=!1),grid:u(n)},null,8,["open","grid"]),k(ee,{"enable-controls":!0,game:u(o),player:u(d),onOnCellClicked:P,onMoveCursor:p,onToggleCellValue:h},null,8,["game","player"]),c("div",st,[at,c("button",{class:L(["btn",{disabled:!z.value}]),onClick:g}," Save puzzle ",2)])])}}});var it=O(rt,[["__scopeId","data-v-176dfd5c"]]);const ut=l=>(K("data-v-e2bfbde6"),l=l(),F(),l),ct=ut(()=>c("h1",null,"Picross",-1)),dt=x(" Nickname "),pt={class:"input-with-button"},vt=x("Play"),ft=x("Play"),_t=x("Create Level"),mt=x("My puzzles"),yt=S({setup(l){const t=W("nickName","");return(e,o)=>{const n=H("router-link");return i(),f(b,null,[ct,c("label",null,[dt,c("div",pt,[Z(c("input",{type:"text",autofocus:"","onUpdate:modelValue":o[0]||(o[0]=a=>ue(t)?t.value=a:null)},null,512),[[Q,u(t)]]),k(n,{class:"btn",to:"/play"},{default:$(()=>[vt]),_:1})])]),c("ul",null,[c("li",null,[k(n,{to:"/play"},{default:$(()=>[ft]),_:1})]),c("li",null,[k(n,{to:"/create"},{default:$(()=>[_t]),_:1})]),c("li",null,[k(n,{to:"/my-puzzles"},{default:$(()=>[mt]),_:1})])])],64)}}});var gt=O(yt,[["__scopeId","data-v-e2bfbde6"]]);const ht=x("Terug"),Ct={key:0},kt={key:1,class:"my-puzzles"},zt=x("Play"),bt=S({setup(l){const t=w(),e=W("nickName","Berend");return Y(()=>{!e.value||D.get(`/users/${e.value}/puzzles`).then(o=>{t.value=o.data.map(n=>{const a=JSON.parse(n.solution);return se(X({},n),{game:le(a,a)})})})}),(o,n)=>{const a=H("router-link");return i(),f(b,null,[k(a,{to:{name:"mainMenu"}},{default:$(()=>[ht]),_:1}),u(e)?U("",!0):(i(),f("div",Ct,"Nog geen puzzels")),t.value?(i(),f("div",kt,[(i(!0),f(b,null,G(t.value,s=>(i(),f("div",{class:"puzzle",key:s.id},[c("h3",null,B(s.name),1),k(ee,{"enable-controls":!1,game:s.game},null,8,["game"]),k(a,{to:{name:"singleplayer",params:{puzzleId:s.id}}},{default:$(()=>[zt]),_:2},1032,["to"])]))),128))])):U("",!0)],64)}}});var wt=O(bt,[["__scopeId","data-v-26f50ce0"]]);const $t=[{name:"mainMenu",path:"/",component:gt},{name:"multiplayer",path:"/play",component:_e},{name:"singleplayer",path:"/play/singleplayer/:puzzleId",component:_e,props:!0},{name:"create",path:"/create",component:it},{name:"myPuzzles",path:"/my-puzzles",component:wt}],It=Se({history:Te(),routes:$t});Me(Oe).use(It).mount("#app");
