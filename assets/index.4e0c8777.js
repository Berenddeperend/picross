var ye=Object.defineProperty,ge=Object.defineProperties;var he=Object.getOwnPropertyDescriptors;var le=Object.getOwnPropertySymbols;var Ce=Object.prototype.hasOwnProperty,ke=Object.prototype.propertyIsEnumerable;var oe=(n,t,e)=>t in n?ye(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e,X=(n,t)=>{for(var e in t||(t={}))Ce.call(t,e)&&oe(n,e,t[e]);if(le)for(var e of le(t))ke.call(t,e)&&oe(n,e,t[e]);return n},se=(n,t)=>ge(n,he(t));import{r as E,o as i,c as f,a as k,F as z,b as c,d as w,e as Y,f as j,g as S,h as T,u,i as G,j as O,n as R,t as B,l as A,k as ae,w as J,m as be,p as ze,q as re,s as $,v as q,x,y as F,z as K,A as ie,B as we,C as $e,T as Ie,D as xe,E as W,G as Z,H as Q,I as ue,J as Se,K as Te,L as Me}from"./vendor.2745e27f.js";const Ne=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))o(l);new MutationObserver(l=>{for(const a of l)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function e(l){const a={};return l.integrity&&(a.integrity=l.integrity),l.referrerpolicy&&(a.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?a.credentials="include":l.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(l){if(l.ep)return;l.ep=!0;const a=e(l);fetch(l.href,a)}};Ne();var U=(n,t)=>{const e=n.__vccOpts||n;for(const[o,l]of t)e[o]=l;return e};const Pe={},Ge=c("div",{id:"modal-target"},null,-1);function Oe(n,t){const e=E("router-view");return i(),f(z,null,[k(e),Ge],64)}var Ue=U(Pe,[["render",Oe]]);const H=w({spacePressed:!1,intention:"build"});function Ve(n){const{toggleCellValue:t,movePlayerCursor:e}=n;function o(l){l.key==="ArrowLeft"?(e("left"),H.value.spacePressed&&t("d")):l.key==="ArrowRight"?(e("right"),H.value.spacePressed&&t("d")):l.key==="ArrowUp"?(e("up"),H.value.spacePressed&&t("d")):l.key==="ArrowDown"?(e("down"),H.value.spacePressed&&t("d")):l.key==="f"?t("x"):l.key===" "&&(H.value.spacePressed=!0,t("d"))}Y(()=>{window.addEventListener("keydown",o),window.addEventListener("keyup",l=>{l.key===" "&&(H.value.spacePressed=!1)})}),j(()=>{window.removeEventListener("keydown",o)})}const Le={key:0,class:"corner"},Re={key:1,class:"legend horizontal"},Ae={key:2,class:"legend vertical"},He=["onMouseover","onClick","onContextmenu","i"],Ee=S({props:{enableControls:{type:Boolean,default:!1},enableSocket:{type:Boolean,default:!1},players:null,player:null,game:null},emits:["onCellClicked","onCellRightClicked","gridChanged","moveCursor","toggleCellValue","onCellHover"],setup(n,{emit:t}){const{gridSize:e,indexToXY:o,hitsInColumns:l,hitsInRows:a,levelIsCleared:s,grid:d,solution:C}=n.game,b=T(()=>{var r;return(r=n.player)==null?void 0:r.position});n.enableControls&&Ve({toggleCellValue:r=>{t("toggleCellValue",r)},movePlayerCursor:r=>{t("moveCursor",r)}});function m(r){if(!(!b||!n.player||!n.players||A.exports.isEqual(o(r),b))&&n.enableSocket){const P=Object.values(n.players).find(_=>A.exports.isEqual(o(r),_.position));return P?`box-shadow: 0px 0px 0px 2px ${P.color}; z-index: 2;`:void 0}}const M=T(()=>{const r=u(C)?"auto repeat(10, 1fr)":"repeat(10, 1fr)";return`
    grid-template-columns: ${r};
    grid-template-rows: ${r};
  `});function h(r,I){const[P,_]=o(r);return u(d)[_][P]===I}function N(r){if(!!n.player)return n.player.position[0]===r}function p(r){if(!!n.player)return n.player.position[1]===r}function g(r){!n.enableControls||t("onCellClicked",r)}function v(r){!n.enableControls||t("onCellRightClicked",r)}function y(r){!n.enableControls||t("onCellHover",r)}return(r,I)=>(i(),f("div",{class:R(["playfield-container",{cleared:u(s)}]),style:ae(u(M))},[u(C)?(i(),f("div",Le)):G("",!0),u(C)?(i(),f("div",Re,[(i(!0),f(z,null,O(u(e),(P,_)=>(i(),f("div",{class:R(["cell",{highlighted:N(_)}]),key:_},[(i(!0),f(z,null,O(u(l)[_],(V,L)=>(i(),f("div",{key:L,class:"hit"},B(V),1))),128))],2))),128))])):G("",!0),u(C)?(i(),f("div",Ae,[(i(!0),f(z,null,O(u(e),(P,_)=>(i(),f("div",{class:R(["cell",{highlighted:p(_)}]),key:_},[(i(!0),f(z,null,O(u(a)[_],(V,L)=>(i(),f("div",{key:L,class:"hit"},B(V),1))),128))],2))),128))])):G("",!0),(i(!0),f(z,null,O(u(e)*u(e),(P,_)=>{var V;return i(),f("div",{class:R(["cell",{cursor:u(A.exports.isEqual)((V=n.player)==null?void 0:V.position,u(o)(_)),filled:h(_,"d"),flagged:h(_,"x")}]),key:_,style:ae(m(_)),onMouseover:L=>y(_),onClick:L=>g(_),onContextmenu:J(L=>v(_),["right","prevent"]),i:_},null,46,He)}),128))],6))}});var ee=U(Ee,[["__scopeId","data-v-5c119636"]]);function te(n){return new Array(n).fill("").map(t=>new Array(n).fill(" "))}const Be=()=>{const t=be("wss://berendswennenhuis.nl",X({path:"/path/"},{transports:["websocket"],upgrade:!1}));return j(()=>{t.disconnect()}),{socket:t}};function ce(n,t,e){const o=n==="multiplayer";let l=w(null),a=w({});o||(l.value="1",a.value={"1":{id:"1",position:[0,0],color:"green",name:"berend"}});const s=T(()=>{var m;return(m=d==null?void 0:d.value)==null?void 0:m.position}),d=T(()=>l.value!==null?a.value[l.value]:null);function C(m){a.value=m}function b(){Y(()=>{!o||(e.on("gridUpdated",t.setGrid),e.on("playersStateUpdated",C),e.on("playerCreated",m=>{l.value=m.id}),e.on("gameCreated",m=>t.setSolution(JSON.parse(m.solution))),e.emit("join",localStorage.getItem("nickName")))}),j(()=>{!o||(e.off("gridUpdated",m=>t.setGrid(m)),e.off("playersStateUpdated",C))})}return{players:a,player:d,playerId:l,cursor:s,initState:b}}function de(n){return n.reduce((t,e,o,l)=>(e==="d"&&(t.length>0&&l[o-1]==="d"?t[t.length-1]++:t.push(1)),t),[])}function pe(n){return n.map(t=>de(t))}function ve(n){const t=n.map((e,o,l)=>l.map(a=>a[o]));return t==null?void 0:t.map(e=>de(e))}const ne=(n,t)=>{const e=w(n||te(10)),o=w(t||null),l=h=>{e.value=h},a=h=>{o.value=h},s=T(()=>e.value[0].length),d=h=>{const N=h%s.value,p=Math.floor(h/s.value);return[N,p]},C=h=>A.exports.clamp(h,0,s.value-1),b=T(()=>A.exports.isEqual(e.value,o==null?void 0:o.value)),m=T(()=>pe(o.value)),M=T(()=>ve(o.value));return{grid:e,solution:o,gridSize:s,hitsInRows:m,hitsInColumns:M,computeHitsInRows:pe,computeHitsInColumns:ve,levelIsCleared:b,indexToXY:d,clampToGrid:C,setGrid:l,setSolution:a}},D=ze.create({baseURL:"https://berendswennenhuis.nl/nonogram/api"});const fe=n=>(F("data-v-f4fa7640"),n=n(),K(),n),qe=x("\u2190 Back"),De={class:"container"},Xe=fe(()=>c("br",null,null,-1)),Ye={class:"now-playing"},je=fe(()=>c("span",{class:"online-indicator"},null,-1)),Je=S({props:{puzzleId:null},setup(n){const t=n.puzzleId?"singleplayer":"multiplayer",e=ne(te(10)),{grid:o}=e;t==="singleplayer"&&D.get(`/puzzle/${n.puzzleId}`).then(p=>{e.setSolution(JSON.parse(p.data.puzzle))});const{socket:l}=Be(),{players:a,player:s,initState:d}=ce(t,e,l);d();function C(p){const[g,v]=e.indexToXY(p);o.value[v][g]=o.value[v][g]===" "?"d":" ",l.emit("gridUpdated",o.value)}function b(p){const[g,v]=e.indexToXY(p);o.value[v][g]=o.value[v][g]===" "?"x":" ",l.emit("gridUpdated",o.value)}function m(p){p==="left"&&(s.value.position[0]=e.clampToGrid(s.value.position[0]-1)),p==="right"&&(s.value.position[0]=e.clampToGrid(s.value.position[0]+1)),p==="up"&&(s.value.position[1]=e.clampToGrid(s.value.position[1]-1)),p==="down"&&(s.value.position[1]=e.clampToGrid(s.value.position[1]+1)),l.emit("cursorUpdated",s.value.position)}function M(p){s.value.position=e.indexToXY(p),l.emit("cursorUpdated",s.value.position)}function h(p){if(e.levelIsCleared.value)return;const[g,v]=s.value.position;o.value[v][g]=o.value[v][g]===p?" ":p,l.emit("gridUpdated",o.value)}function N(p){var g;return p.id===((g=s.value)==null?void 0:g.id)}return re(e.levelIsCleared,p=>{p&&(ie({zIndex:-1,particleCount:50,spread:70,angle:60,origin:{y:.6}}),ie({zIndex:-1,particleCount:50,spread:70,angle:120,origin:{y:.6}}))}),(p,g)=>{const v=E("router-link");return i(),f(z,null,[c("header",null,[k(v,{class:"link",to:{name:"mainMenu"}},{default:$(()=>[qe]),_:1})]),c("div",De,[u(e).grid&&u(e).solution?(i(),q(ee,{key:0,class:"grid","enable-controls":!0,"enable-socket":!0,game:u(e),player:u(s),players:u(a),onOnCellClicked:C,onOnCellRightClicked:b,onOnCellHover:M,onMoveCursor:m,onToggleCellValue:h},null,8,["game","player","players"])):G("",!0),c("aside",null,[Xe,c("span",Ye,"Now playing ("+B(Object.values(u(a)).length)+")",1),c("ul",null,[(i(!0),f(z,null,O(u(a),y=>(i(),f("li",{class:R([{"current-player":N(y)},y.id]),ref_for:!0,ref:"playersRef"},[je,x(" "+B(y.name),1)],2))),256))])])])],64)}}});var _e=U(Je,[["__scopeId","data-v-f4fa7640"]]);const Fe={class:"modal"},Ke=S({props:{visible:{type:Boolean}},emits:["close"],setup(n,{emit:t}){return we("Escape",()=>{!n.visible||t("close")}),(e,o)=>(i(),q(xe,{to:"#modal-target"},[k(Ie,null,{default:$(()=>[n.visible?(i(),f("div",{key:0,class:"backdrop",onClick:o[0]||(o[0]=J(l=>e.$emit("close"),["self"]))},[c("div",Fe,[$e(e.$slots,"default",{},void 0,!0)])])):G("",!0)]),_:3})]))}});var me=U(Ke,[["__scopeId","data-v-2272df04"]]);const We=["onSubmit"],Ze=["disabled"],Qe=S({props:{open:null,grid:null},emits:["close"],setup(n,{emit:t}){const e=w(""),o=W("nickName","");function l(a){D.post("/puzzle",{name:e.value,solution:JSON.stringify(n.grid),authorName:o.value}).then(s=>{t("close")}).catch(s=>{console.log(s)})}return(a,s)=>(i(),q(me,{visible:n.open,onClose:s[2]||(s[2]=d=>t("close"))},{default:$(()=>[c("form",{onSubmit:J(l,["prevent"])},[Z(c("input",{type:"text",placeholder:"Uw naam","onUpdate:modelValue":s[0]||(s[0]=d=>ue(o)?o.value=d:null)},null,512),[[Q,u(o)]]),Z(c("input",{type:"text",placeholder:"Puzzel naam","onUpdate:modelValue":s[1]||(s[1]=d=>e.value=d)},null,512),[[Q,e.value]]),c("button",{disabled:e.value===""||u(o)===""},"Save",8,Ze)],40,We)]),_:1},8,["visible"]))}}),et=c("p",null,"De puzzel is niet goed.",-1),tt=S({props:{open:null},emits:["close"],setup(n,{emit:t}){return(e,o)=>(i(),q(me,{visible:n.open,onClose:o[0]||(o[0]=l=>t("close"))},{default:$(()=>[et]),_:1},8,["visible"]))}});const nt=n=>(F("data-v-176dfd5c"),n=n(),K(),n),lt={class:"create"},ot=x("\u2190 Terug"),st={class:"btns-container"},at=nt(()=>c("button",{class:"btn btn-link"},"Clear",-1)),rt=S({setup(n){const t=w(!1),e=w(!1),o=ne(te(10)),{grid:l,computeHitsInRows:a,computeHitsInColumns:s}=o;console.log("-> grid",l);const{player:d}=ce("singleplayer",o),C=w(!1),b=w(!1);function m(){const v=I=>I.length?I:[0],y=s(l.value).map(v),r=a(l.value).map(v);D.post("/validate-puzzle",{legendData:{rows:r,columns:y}}).then(I=>{C.value=!0,b.value=I.data})}const M=A.exports.debounce(m,400);function h(v){if(t.value||o.levelIsCleared.value)return;const[y,r]=d.value.position;l.value[r][y]=l.value[r][y]===v?" ":v}function N(v){const[y,r]=o.indexToXY(v);l.value[r][y]=l.value[r][y]===" "?"d":" "}function p(v){t.value||(v==="left"&&(d.value.position[0]=o.clampToGrid(d.value.position[0]-1)),v==="right"&&(d.value.position[0]=o.clampToGrid(d.value.position[0]+1)),v==="up"&&(d.value.position[1]=o.clampToGrid(d.value.position[1]-1)),v==="down"&&(d.value.position[1]=o.clampToGrid(d.value.position[1]+1)))}function g(){b.value?t.value=!0:e.value=!0}return re(l,()=>{C.value=!1,M()},{deep:!0}),(v,y)=>{const r=E("router-link");return i(),f("div",lt,[c("header",null,[k(r,{class:"link",to:{name:"mainMenu"}},{default:$(()=>[ot]),_:1})]),k(tt,{open:e.value,onClose:y[0]||(y[0]=I=>e.value=!1)},null,8,["open"]),k(Qe,{open:t.value,onClose:y[1]||(y[1]=I=>t.value=!1),grid:u(l)},null,8,["open","grid"]),k(ee,{"enable-controls":!0,game:u(o),player:u(d),onOnCellClicked:N,onMoveCursor:p,onToggleCellValue:h},null,8,["game","player"]),c("div",st,[at,c("button",{class:R(["btn",{disabled:!b.value}]),onClick:g}," Save puzzle ",2)])])}}});var it=U(rt,[["__scopeId","data-v-176dfd5c"]]);const ut=n=>(F("data-v-e2bfbde6"),n=n(),K(),n),ct=ut(()=>c("h1",null,"Picross",-1)),dt=x(" Nickname "),pt={class:"input-with-button"},vt=x("Play"),ft=x("Play"),_t=x("Create Level"),mt=x("My puzzles"),yt=S({setup(n){const t=W("nickName","");return(e,o)=>{const l=E("router-link");return i(),f(z,null,[ct,c("label",null,[dt,c("div",pt,[Z(c("input",{type:"text",autofocus:"","onUpdate:modelValue":o[0]||(o[0]=a=>ue(t)?t.value=a:null)},null,512),[[Q,u(t)]]),k(l,{class:"btn",to:"/play"},{default:$(()=>[vt]),_:1})])]),c("ul",null,[c("li",null,[k(l,{to:"/play"},{default:$(()=>[ft]),_:1})]),c("li",null,[k(l,{to:"/create"},{default:$(()=>[_t]),_:1})]),c("li",null,[k(l,{to:"/my-puzzles"},{default:$(()=>[mt]),_:1})])])],64)}}});var gt=U(yt,[["__scopeId","data-v-e2bfbde6"]]);const ht=x("Terug"),Ct={key:0},kt={key:1,class:"my-puzzles"},bt=x("Play"),zt=S({setup(n){const t=w(),e=W("nickName","Berend");return Y(()=>{!e.value||D.get(`/users/${e.value}/puzzles`).then(o=>{t.value=o.data.map(l=>{const a=JSON.parse(l.solution);return se(X({},l),{game:ne(a,a)})})})}),(o,l)=>{const a=E("router-link");return i(),f(z,null,[k(a,{to:{name:"mainMenu"}},{default:$(()=>[ht]),_:1}),u(e)?G("",!0):(i(),f("div",Ct,"Nog geen puzzels")),t.value?(i(),f("div",kt,[(i(!0),f(z,null,O(t.value,s=>(i(),f("div",{class:"puzzle",key:s.id},[c("h3",null,B(s.name),1),k(ee,{"enable-controls":!1,game:s.game},null,8,["game"]),k(a,{to:{name:"singleplayer",params:{puzzleId:s.id}}},{default:$(()=>[bt]),_:2},1032,["to"])]))),128))])):G("",!0)],64)}}});var wt=U(zt,[["__scopeId","data-v-26f50ce0"]]);const $t=[{name:"mainMenu",path:"/",component:gt},{name:"multiplayer",path:"/play",component:_e},{name:"singleplayer",path:"/play/singleplayer/:puzzleId",component:_e,props:!0},{name:"create",path:"/create",component:it},{name:"myPuzzles",path:"/my-puzzles",component:wt}],It=Se({history:Te(),routes:$t});Me(Ue).use(It).mount("#app");
